import type { ProductListingPage } from "../../commerce/types.ts";
import { mapProductToAnalyticsItem } from "../../commerce/utils/productToAnalyticsItem.ts";
import { SendEventOnView } from "../../components/Analytics.tsx";
import Filters from "../../components/search/Filters.tsx";
// import SearchControls from "../../islands/SearchControls.tsx";
import SearchControls from "./Controls.tsx";
import ClearFiltersButton from "../../islands/ClearFiltersButton.tsx";
import { useId } from "../../sdk/useId.ts";
import { useOffer } from "../../sdk/useOffer.ts";
import ProductGallery, { Columns } from "../product/ProductGallery.tsx";
import NotFoundComponent from "./NotFound.tsx";
import { AppContext } from "../../apps/site.ts";
import ContenteSeoSubtance from "./ContenteSeoSubtance.tsx";
import ContentSeo from "./ContentSeo.tsx";
import Slider from "deco-sites/consul-remedio/components/ui/Slider.tsx";
import Icon from "deco-sites/consul-remedio/components/ui/Icon.tsx";
import ContentFactory from "./ContentFactory.tsx";

export type Format = "Show More" | "Pagination";

export interface Layout {
  /**
   * @description Use drawer for mobile like behavior on desktop. Aside for rendering the filters alongside the products
   */
  variant?: "aside" | "drawer";
  /**
   * @description Number of products per line on grid
   */
  columns?: Columns;
  /**
   * @description Format of the pagination
   */
  format?: Format;
}

export interface Props {
  /** @title Integration */
  page: ProductListingPage | null;
  layout?: Layout;

  /** @description 0 for ?page=0 as your first page */
  startingPage?: 0 | 1;
}

function NotFound() {
  return (
    <div class="w-full flex justify-center items-center py-10">
      <NotFoundComponent />
    </div>
  );
}

function Result({
  page,
  layout,
  startingPage = 0,
  url: urlProps,
}: Omit<Props, "page"> & {
  page: ProductListingPage;
  url: string;
}) {
  const {
    products,
    filters,
    breadcrumb,
    pageInfo,
    sortOptions,
    contentSeoSubstance,
    contentSeo,
    factoryDescription,
  } = page;
  const perPage = pageInfo?.recordPerPage || products.length;
  const url = new URL(urlProps);

  const { format = "Show More" } = layout ?? {};

  const id = useId();
  const idTerm = "term-carrousel-id";

  const zeroIndexedOffsetPage = pageInfo.currentPage - startingPage;
  const offset = zeroIndexedOffsetPage * perPage;

  const isPartial = url.searchParams.get("partial") === "true";
  const isFirstPage = !pageInfo.previousPage;

  const currentPage = pageInfo?.currentPage ? pageInfo?.currentPage - 1 : 1;

  const totalPages = pageInfo.records && pageInfo.recordPerPage
    ? Math.ceil(pageInfo?.records / pageInfo?.recordPerPage)
    : 0;

  const isHaveFilter = url.searchParams.get("filtro") !== null;

  console.log(pageInfo.nextPage);

  return (
    <>
      <div class="max-w-[1466px] lg:px-10 lg:m-auto px-0 lg:pb-10 lg:pt-5">
        {(isFirstPage || !isPartial) && (
          <SearchControls
            sortOptions={sortOptions}
            filters={filters}
            breadcrumb={breadcrumb}
            displayFilter={layout?.variant === "drawer"}
            page={page}
            filtersActive={page?.filtersActive}
          />
        )}

        <div class="flex flex-row lg:overflow-visible lg:border-t lg:border-neutral">
          {layout?.variant === "aside" &&
            filters.length > 0 &&
            (isFirstPage || !isPartial) &&
            products &&
            products.length > 0 && (
            <div class="hidden lg:block min-w-80 lg:sticky lg:top-0 lg:h-full lg:max-w-80">
              <Filters
                filters={filters}
                filtersActive={page?.filtersActive}
              />
            </div>
          )}
          <div class="flex-grow" id={id}>
            {products && products.length > 0
              ? (
                <ProductGallery
                  products={products}
                  offset={offset}
                  layout={{ columns: layout?.columns, format }}
                  pageInfo={pageInfo}
                  url={url}
                />
              )
              : (
                <div class="flex flex-col items-center justify-center px-4 lg:px-8 py-8">
                  <div class="text-center flex flex-col items-center">
                    <svg
                      class="max-lg:max-w-[80%]"
                      width="410"
                      height="225"
                      viewBox="0 0 410 225"
                      fill="none"
                      xmlns="http://www.w3.org/2000/svg"
                    >
                      <path
                        d="M256.195 141.795C241.347 154.946 209.105 214.975 225.014 214.996C236.892 215.011 256.195 192.279 256.195 141.795Z"
                        fill="#343A40"
                      />
                      <path
                        d="M366.895 102.095C377.314 89.6099 360.203 97.0843 353.379 100.453C344.89 104.644 336.066 108.882 321.615 116.253C311.262 121.543 282.212 134.472 259.972 146.881C255.254 140.336 242.555 123.092 237.365 116.939C228.38 106.289 208.093 87.3222 188.139 90.8008C180.72 92.0942 174.567 142.012 174.567 142.012C174.567 142.012 194.554 184.962 226.058 204.531C252.582 221.006 273.287 211.33 291.206 197.048C321.138 173.19 340.677 152.438 347.548 146.538C353.491 141.434 363.026 134.725 363.026 134.725L367.453 112.904L356.679 113.829C356.679 113.829 358.9 111.676 366.895 102.095Z"
                        fill="white"
                      />
                      <path
                        d="M253.347 213.766C244.257 213.766 235.158 210.876 225.748 205.031C218.518 200.54 211.299 194.443 204.292 186.908C198.694 180.889 193.217 173.944 188.013 166.265C179.154 153.193 174.085 142.37 174.035 142.262C173.989 142.162 173.971 142.052 173.984 141.943C174 141.818 175.553 129.298 177.995 116.781C179.431 109.417 180.89 103.49 182.331 99.1649C184.249 93.4099 186.062 90.5692 188.038 90.2247C196.949 88.6712 206.756 91.3147 217.184 98.0816C226.868 104.365 234.265 112.358 237.813 116.563C243.071 122.795 255.681 139.943 260.142 146.116C275.381 137.644 293.645 128.985 307.017 122.645C312.98 119.818 318.13 117.376 321.347 115.732C332.333 110.129 340.057 106.341 346.873 102.999C349.023 101.944 351.081 100.935 353.119 99.9287C354.727 99.1349 358.875 97.1467 362.667 95.8318C367.025 94.3199 369.484 94.1607 370.405 95.3304C371.366 96.5509 370.393 98.8204 367.346 102.473C362.252 108.576 359.506 111.664 358.17 113.114L367.402 112.321C367.587 112.306 367.767 112.378 367.89 112.516C368.013 112.653 368.064 112.841 368.027 113.023L363.601 134.844C363.571 134.991 363.486 135.121 363.364 135.208C363.269 135.275 353.783 141.959 347.93 146.985C346.048 148.601 343.127 151.418 339.429 154.985C329.645 164.42 313.271 180.213 291.571 197.509C280.745 206.138 271.34 211.029 261.974 212.901C259.094 213.477 256.22 213.765 253.347 213.766ZM175.171 141.918C175.814 143.269 180.754 153.465 188.996 165.624C203.704 187.32 217.437 198.487 226.368 204.034C238.486 211.562 250.058 214.086 261.744 211.75C270.92 209.916 280.165 205.099 290.84 196.591C312.497 179.329 328.846 163.561 338.614 154.14C342.326 150.56 345.258 147.732 347.166 146.094C352.598 141.429 361.117 135.36 362.498 134.383L366.722 113.558L356.729 114.416C356.481 114.435 356.248 114.3 356.145 114.075C356.042 113.849 356.092 113.583 356.271 113.41C356.293 113.389 358.587 111.138 366.445 101.721C370.025 97.4311 369.676 96.3007 369.483 96.0564C369.288 95.8083 368.247 95.1386 363.052 96.9405C359.323 98.2337 355.227 100.197 353.639 100.981C351.601 101.987 349.544 102.996 347.394 104.051C340.581 107.391 332.86 111.178 321.882 116.778C318.65 118.429 313.494 120.873 307.524 123.703C294.033 130.1 275.555 138.86 260.258 147.395C259.998 147.54 259.67 147.468 259.496 147.226C255.343 141.465 242.278 123.674 236.916 117.32C234.094 113.974 226.459 105.498 216.546 99.0659C206.374 92.4653 196.85 89.8799 188.24 91.3808C186.657 91.6568 183.371 95.3522 179.148 117.001C176.868 128.69 175.364 140.386 175.171 141.918Z"
                        fill="#343A40"
                      />
                      <path
                        d="M340.824 121.107C340.413 121.107 340.032 121.079 339.683 121.02C339.364 120.967 339.148 120.665 339.201 120.345C339.255 120.025 339.558 119.809 339.877 119.863C343.974 120.549 353.431 116.407 357.486 111.233C357.686 110.978 358.055 110.933 358.31 111.133C358.565 111.333 358.61 111.702 358.41 111.957C356.466 114.438 353.127 116.919 349.25 118.763C346.08 120.271 343.038 121.107 340.824 121.107Z"
                        fill="#343A40"
                      />
                      <path
                        d="M409.363 83.9283C408.974 78.7283 406.521 73.9003 402.551 70.5193L402.4 70.393C394.087 63.417 381.693 64.5009 374.716 72.8141C371.409 76.7551 369.78 81.8358 370.177 86.9654C370.404 89.9904 371.333 92.9212 372.89 95.5247C372.894 95.5307 372.898 95.5376 372.901 95.5446C373.509 96.5602 374.209 97.5178 374.993 98.4049C375.257 98.7087 375.534 99.0027 375.82 99.2891C376.192 99.6656 376.582 100.027 376.989 100.375L377.138 100.501C385.451 107.478 397.847 106.394 404.824 98.0802C408.131 94.1391 409.761 89.0581 409.363 83.9283ZM379.668 97.4871L379.549 97.3871C372.955 91.7425 372.185 81.8211 377.83 75.227C380.541 72.06 384.399 70.1 388.555 69.778C392.658 69.4478 396.725 70.7521 399.871 73.4068L399.991 73.5079C406.583 79.1549 407.35 89.0767 401.703 95.6688C396.098 102.212 386.269 103.023 379.668 97.4871Z"
                        fill="#343A40"
                      />
                      <path
                        d="M374.259 96.834C374.808 97.6894 375.415 98.5063 376.075 99.2796L369.863 104.088C369.809 104.128 369.753 104.165 369.694 104.197C368.963 104.612 368.034 104.355 367.619 103.624C367.282 103.03 367.382 102.284 367.864 101.8C367.914 101.749 367.967 101.702 368.024 101.66L374.259 96.834Z"
                        fill="#343A40"
                      />
                      <path
                        d="M345.929 121.429C344.894 120.038 345.183 118.071 346.574 117.036C346.617 117.004 346.661 116.973 346.705 116.944L368.077 100.057C368.463 99.7947 368.987 99.8829 369.266 100.257L371.347 103.054C371.625 103.429 371.559 103.956 371.197 104.25L350.448 121.976C349.111 123.08 347.132 122.891 346.027 121.554C345.994 121.513 345.961 121.472 345.929 121.429Z"
                        fill="#343A40"
                      />
                      <path
                        d="M374.894 113.167C376.521 109.026 371.808 106.576 361.752 108.599C354.037 110.151 341.765 115.343 354.523 117.11C356.059 117.323 357.656 117.178 359.389 117.339C353.26 118.495 347.114 121.329 347.124 123.344C347.128 124.043 347.872 124.643 349.614 125.04C351.523 125.475 354.783 126.035 356.573 126.241C356.358 126.279 356.156 126.313 355.973 126.344C348.899 127.529 338.961 131.847 348.892 133.718C350.41 134.004 351.098 134.146 352.665 134.244C351.864 134.429 349.812 134.939 349.261 135.059C345.343 135.908 342.412 138.043 345.157 139.42C349.233 141.466 358.57 141.309 363.328 138.794C365.846 137.464 366.711 134.747 363.708 133.268C364.475 133.074 365.222 132.947 365.892 132.7C369.854 131.238 371.879 126.919 369.338 125.024C369.314 125.006 370.779 124.396 371.704 123.564C374.201 121.317 374.347 117.702 370.217 116.706C372.204 116.145 374.182 114.978 374.894 113.167Z"
                        fill="white"
                      />
                      <path
                        d="M353.036 141.404C349.875 141.404 346.854 140.928 344.894 139.944C343.623 139.306 343.439 138.521 343.508 137.974C343.655 136.813 345.452 135.283 349.137 134.484C349.21 134.468 349.311 134.445 349.433 134.417C349.307 134.393 349.176 134.368 349.038 134.342L348.783 134.294C346.772 133.915 344.1 133.212 344.118 131.49C344.13 130.308 345.526 129.115 348.268 127.946C349.714 127.33 351.441 126.765 353.186 126.329C351.844 126.1 350.477 125.837 349.483 125.611C347.534 125.167 346.542 124.404 346.537 123.346C346.527 121.271 350.815 119.124 355.225 117.773C354.963 117.753 354.703 117.727 354.442 117.691C350.368 117.127 348.45 116.18 348.406 114.712C348.366 113.408 349.906 112.089 353.113 110.679C355.588 109.592 358.774 108.599 361.636 108.023C368.26 106.691 373.128 107.203 374.992 109.427C375.884 110.491 376.038 111.858 375.439 113.381C374.897 114.76 373.646 115.929 371.912 116.713C372.978 117.283 373.683 118.122 373.946 119.162C374.35 120.756 373.641 122.61 372.096 124C371.555 124.486 370.855 124.897 370.334 125.173C370.919 125.904 371.156 126.838 371.006 127.877C370.685 130.092 368.666 132.301 366.094 133.25C365.787 133.363 365.474 133.451 365.152 133.53C365.824 134.144 366.189 134.888 366.2 135.705C366.22 137.073 365.224 138.455 363.602 139.312C360.998 140.688 356.912 141.404 353.036 141.404ZM368.147 108.457C366.511 108.457 364.453 108.654 361.867 109.174C359.125 109.725 355.952 110.714 353.585 111.754C350.602 113.065 349.563 114.147 349.579 114.676C349.585 114.87 349.855 115.87 354.603 116.528C355.397 116.638 356.217 116.648 357.086 116.659C357.842 116.668 358.623 116.678 359.444 116.754C359.735 116.781 359.962 117.019 359.975 117.311C359.989 117.603 359.785 117.861 359.498 117.915C352.651 119.206 347.705 122.052 347.711 123.34C347.713 123.661 348.248 124.126 349.745 124.467C351.616 124.893 354.838 125.449 356.64 125.657C356.93 125.691 357.152 125.932 357.16 126.224C357.168 126.516 356.961 126.769 356.673 126.819C356.457 126.856 356.254 126.891 356.07 126.922C353.588 127.337 350.843 128.124 348.728 129.026C346.199 130.105 345.297 131.034 345.292 131.502C345.288 131.935 346.256 132.624 349.001 133.141L349.257 133.189C350.592 133.441 351.262 133.568 352.702 133.658C352.992 133.676 353.226 133.905 353.25 134.195C353.274 134.486 353.081 134.75 352.797 134.815C352.438 134.898 351.826 135.047 351.212 135.196C350.432 135.385 349.696 135.564 349.386 135.631C346.593 136.237 344.765 137.396 344.673 138.121C344.632 138.447 345.124 138.746 345.421 138.895C349.444 140.914 358.673 140.59 363.054 138.275C364.266 137.634 365.041 136.632 365.028 135.722C365.014 134.764 364.162 134.144 363.449 133.793C363.228 133.684 363.099 133.45 363.125 133.205C363.151 132.96 363.326 132.758 363.565 132.698C363.807 132.636 364.048 132.582 364.285 132.528C364.788 132.413 365.263 132.306 365.689 132.149C367.875 131.342 369.584 129.517 369.846 127.709C369.939 127.061 369.867 126.149 368.988 125.494C368.823 125.371 368.735 125.172 368.754 124.968C368.785 124.634 369.025 124.517 369.257 124.403C369.638 124.217 370.651 123.722 371.312 123.127C372.532 122.029 373.106 120.62 372.809 119.45C372.542 118.394 371.598 117.642 370.08 117.276C369.82 117.213 369.636 116.983 369.631 116.716C369.626 116.45 369.801 116.213 370.058 116.141C371.085 115.851 373.559 114.96 374.349 112.951C374.786 111.837 374.701 110.905 374.094 110.181C373.677 109.684 372.23 108.457 368.147 108.457Z"
                        fill="#343A40"
                      />
                      <path
                        d="M359.238 117.969C358.953 117.969 358.703 117.762 358.658 117.472C358.609 117.152 358.828 116.852 359.149 116.802L359.302 116.778C363.08 116.193 367.364 115.529 371.53 116.436C371.847 116.505 372.048 116.817 371.979 117.134C371.91 117.451 371.596 117.652 371.281 117.583C367.327 116.722 363.159 117.368 359.482 117.938L359.328 117.962C359.298 117.967 359.267 117.969 359.238 117.969Z"
                        fill="#343A40"
                      />
                      <path
                        d="M369.551 125.199C367.384 123.012 361.003 125.551 354.445 126.639L369.551 125.199Z"
                        fill="white"
                      />
                      <path
                        d="M354.444 127.226C354.162 127.226 353.914 127.022 353.866 126.735C353.813 126.415 354.029 126.113 354.349 126.06C356.196 125.754 358.014 125.335 359.772 124.929C364.474 123.845 368.187 122.989 369.968 124.786C370.196 125.017 370.194 125.388 369.964 125.616C369.733 125.845 369.362 125.842 369.134 125.612C367.813 124.279 364.035 125.151 360.036 126.073C358.26 126.482 356.424 126.906 354.541 127.218C354.508 127.223 354.476 127.226 354.444 127.226Z"
                        fill="#343A40"
                      />
                      <path
                        d="M365.341 134.693C362.39 130.412 353.884 134.165 347.969 135.396L365.341 134.693Z"
                        fill="white"
                      />
                      <path
                        d="M347.968 135.983C347.696 135.983 347.452 135.793 347.394 135.516C347.328 135.199 347.532 134.888 347.849 134.822C349.119 134.558 350.499 134.178 351.961 133.777C357.266 132.319 363.279 130.668 365.824 134.36C366.008 134.627 365.941 134.992 365.674 135.176C365.407 135.36 365.042 135.293 364.858 135.026C362.786 132.02 357.2 133.555 352.272 134.908C350.792 135.315 349.394 135.699 348.088 135.971C348.048 135.979 348.008 135.983 347.968 135.983Z"
                        fill="#343A40"
                      />
                      <path
                        d="M69.3195 176.582C51.2896 167.885 16.9433 148.384 8.86622 157.915C-1.73977 170.43 69.3195 176.582 69.3195 176.582Z"
                        fill="#343A40"
                      />
                      <path
                        d="M225.014 214.995H85.3401L91.1674 189.523C91.1674 189.523 84.6398 185.603 75.2327 180.442C57.8837 170.926 30.7384 157.19 16.6835 156.053C13.1058 155.764 10.375 156.29 8.86877 157.911C9.1485 157.555 31.8475 128.485 59.7088 107.224C69.5795 99.6909 80.0957 93.1378 90.4945 89.1903C105.271 83.5782 119.805 83.228 131.894 92.7955L174.53 93.8577C191.429 80.4345 230.222 93.934 262.302 145.398C252.12 154.306 209.105 210.946 225.014 214.995Z"
                        fill="#009999"
                      />
                      <mask
                        id="mask0_3031_327669"
                        style="mask-type:luminance"
                        maskUnits="userSpaceOnUse"
                        x="8"
                        y="85"
                        width="249"
                        height="130"
                      >
                        <path
                          d="M174.53 93.8562C191.897 81.9418 229.78 83.2328 256.195 141.795C246.013 150.704 209.105 210.945 225.014 214.996H85.3398L91.1677 189.521C91.1677 189.521 19.4721 146.461 8.86633 157.915C8.86633 157.915 87.1375 57.3719 131.894 92.7954L174.53 93.8562Z"
                          fill="white"
                        />
                      </mask>
                      <g mask="url(#mask0_3031_327669)">
                        <path
                          d="M169.087 127.589C168.856 127.589 168.622 127.569 168.387 127.527C164.401 126.82 160.022 120.222 155.356 107.904C154.942 111.535 153.67 115.64 151.802 119.209C149.184 124.212 145.956 127.149 142.947 127.267C142.881 127.269 142.814 127.271 142.748 127.271C138.186 127.271 132.54 121.08 131.073 92.1593C131.057 91.8355 131.306 91.5599 131.63 91.5435C131.953 91.5259 132.229 91.7759 132.245 92.0998C132.862 104.265 134.285 113.371 136.473 119.165C137.673 122.343 139.732 126.097 142.757 126.097C142.805 126.097 142.852 126.096 142.901 126.094C145.44 125.995 148.379 123.218 150.762 118.665C153.068 114.259 154.432 109.026 154.322 105.008C154.314 104.72 154.517 104.469 154.8 104.416C155.083 104.363 155.364 104.523 155.461 104.795C158.212 112.471 163.576 125.482 168.591 126.371C169.736 126.574 170.769 126.104 171.747 124.931C176.089 119.726 177.231 102.81 173.853 93.7248C173.74 93.4208 173.895 93.0832 174.199 92.9703C174.502 92.856 174.84 93.012 174.953 93.3157C176.589 97.7151 177.303 104.267 176.864 110.843C176.412 117.604 174.876 123.013 172.649 125.683C171.601 126.94 170.381 127.589 169.087 127.589Z"
                          fill="white"
                        />
                      </g>
                      <mask
                        id="mask1_3031_327669"
                        style="mask-type:luminance"
                        maskUnits="userSpaceOnUse"
                        x="8"
                        y="85"
                        width="249"
                        height="130"
                      >
                        <path
                          d="M174.53 93.8562C191.897 81.9418 229.78 83.2328 256.195 141.795C246.013 150.704 209.105 210.945 225.014 214.996H85.3398L91.1677 189.521C91.1677 189.521 19.4721 146.461 8.86633 157.915C8.86633 157.915 87.1375 57.3719 131.894 92.7954L174.53 93.8562Z"
                          fill="white"
                        />
                      </mask>
                      <g mask="url(#mask1_3031_327669)">
                        <path
                          d="M152.947 126.85C153.598 126.85 154.126 126.322 154.126 125.671C154.126 125.02 153.598 124.492 152.947 124.492C152.296 124.492 151.768 125.02 151.768 125.671C151.768 126.322 152.296 126.85 152.947 126.85Z"
                          fill="white"
                        />
                      </g>
                      <mask
                        id="mask2_3031_327669"
                        style="mask-type:luminance"
                        maskUnits="userSpaceOnUse"
                        x="8"
                        y="85"
                        width="249"
                        height="130"
                      >
                        <path
                          d="M174.53 93.8562C191.897 81.9418 229.78 83.2328 256.195 141.795C246.013 150.704 209.105 210.945 225.014 214.996H85.3398L91.1677 189.521C91.1677 189.521 19.4721 146.461 8.86633 157.915C8.86633 157.915 87.1375 57.3719 131.894 92.7954L174.53 93.8562Z"
                          fill="white"
                        />
                      </mask>
                      <g mask="url(#mask2_3031_327669)">
                        <path
                          d="M153.73 142.881C154.381 142.881 154.909 142.353 154.909 141.702C154.909 141.051 154.381 140.523 153.73 140.523C153.079 140.523 152.551 141.051 152.551 141.702C152.551 142.353 153.079 142.881 153.73 142.881Z"
                          fill="white"
                        />
                      </g>
                      <mask
                        id="mask3_3031_327669"
                        style="mask-type:luminance"
                        maskUnits="userSpaceOnUse"
                        x="8"
                        y="85"
                        width="249"
                        height="130"
                      >
                        <path
                          d="M174.53 93.8562C191.897 81.9418 229.78 83.2328 256.195 141.795C246.013 150.704 209.105 210.945 225.014 214.996H85.3398L91.1677 189.521C91.1677 189.521 19.4721 146.461 8.86633 157.915C8.86633 157.915 87.1375 57.3719 131.894 92.7954L174.53 93.8562Z"
                          fill="white"
                        />
                      </mask>
                      <g mask="url(#mask3_3031_327669)">
                        <path
                          d="M149.958 154.042C149.668 154.042 149.416 153.827 149.377 153.532C149.334 153.21 149.56 152.915 149.882 152.873C149.948 152.864 156.622 151.908 157.435 146.49C158.589 138.8 154.369 105.403 154.327 105.066C154.286 104.745 154.513 104.451 154.835 104.41C155.156 104.37 155.45 104.597 155.491 104.918C155.666 106.299 159.773 138.813 158.596 146.664C157.651 152.961 150.111 154.026 150.035 154.036C150.009 154.04 149.983 154.042 149.958 154.042Z"
                          fill="white"
                        />
                      </g>
                      <mask
                        id="mask4_3031_327669"
                        style="mask-type:luminance"
                        maskUnits="userSpaceOnUse"
                        x="8"
                        y="85"
                        width="249"
                        height="130"
                      >
                        <path
                          d="M174.53 93.8562C191.897 81.9418 229.78 83.2328 256.195 141.795C246.013 150.704 209.105 210.945 225.014 214.996H85.3398L91.1677 189.521C91.1677 189.521 19.4721 146.461 8.86633 157.915C8.86633 157.915 87.1375 57.3719 131.894 92.7954L174.53 93.8562Z"
                          fill="white"
                        />
                      </mask>
                      <g mask="url(#mask4_3031_327669)">
                        <path
                          d="M90.4252 186.396C90.275 186.396 90.125 186.338 90.0103 186.224C89.7811 185.995 89.7811 185.623 90.0103 185.394C90.1453 185.259 103.614 171.688 111.746 155.007C111.888 154.715 112.239 154.594 112.531 154.737C112.822 154.879 112.943 155.23 112.801 155.521C104.58 172.384 90.9767 186.087 90.8401 186.224C90.7255 186.338 90.5755 186.396 90.4252 186.396Z"
                          fill="white"
                        />
                      </g>
                      <mask
                        id="mask5_3031_327669"
                        style="mask-type:luminance"
                        maskUnits="userSpaceOnUse"
                        x="8"
                        y="85"
                        width="249"
                        height="130"
                      >
                        <path
                          d="M174.53 93.8561C191.897 81.9417 229.78 83.2327 256.195 141.795C246.013 150.703 209.105 210.945 225.014 214.995H85.3398L91.1677 189.521C91.1677 189.521 19.4721 146.461 8.86633 157.915C8.86633 157.915 87.1375 57.3718 131.894 92.7953L174.53 93.8561Z"
                          fill="white"
                        />
                      </mask>
                      <g mask="url(#mask5_3031_327669)">
                        <path
                          d="M223.211 213.971C223.069 213.971 222.926 213.92 222.814 213.816C209.423 201.506 198.829 174.175 196.329 159.179C196.276 158.859 196.492 158.557 196.812 158.503C197.13 158.449 197.434 158.666 197.487 158.986C199.959 173.816 210.411 200.82 223.608 212.952C223.847 213.172 223.862 213.543 223.643 213.781C223.527 213.907 223.369 213.971 223.211 213.971Z"
                          fill="white"
                        />
                      </g>
                      <path
                        d="M174.607 3.83663C171.772 2.99236 167.727 3.33351 164.5 5.93419C158.807 -4.57242 144.37 0.348829 144.048 9.26628C132.224 3.47493 121.923 17.4746 128.002 26.0161C130.234 29.1518 134.228 35.8414 133.838 41.9899C139.302 43.2669 151.097 53.6655 151.097 53.6655C151.097 53.6655 168.684 27.6602 176.727 23.3736C186.767 18.0225 182.083 6.06349 174.607 3.83663Z"
                        fill="#343A40"
                      />
                      <mask
                        id="mask6_3031_327669"
                        style="mask-type:luminance"
                        maskUnits="userSpaceOnUse"
                        x="126"
                        y="0"
                        width="57"
                        height="54"
                      >
                        <path
                          d="M174.607 3.83663C171.772 2.99236 167.727 3.33351 164.5 5.93419C158.807 -4.57242 144.37 0.348829 144.048 9.26628C132.224 3.47493 121.923 17.4746 128.003 26.0161C130.234 29.1518 134.228 35.8414 133.838 41.9899C139.302 43.2669 151.097 53.6655 151.097 53.6655C151.097 53.6655 168.684 27.6602 176.727 23.3736C186.767 18.0225 182.083 6.06349 174.607 3.83663Z"
                          fill="white"
                        />
                      </mask>
                      <g mask="url(#mask6_3031_327669)">
                        <path
                          d="M160.463 12.8998C160.441 12.8998 160.418 12.8984 160.395 12.8957C160.073 12.8585 159.842 12.5671 159.88 12.2453C160.648 5.63393 166.912 2.94952 167.178 2.83841C167.477 2.71361 167.821 2.85484 167.946 3.15413C168.071 3.45303 167.929 3.79633 167.631 3.92133C167.566 3.94852 161.732 6.46646 161.045 12.3807C161.011 12.6796 160.757 12.8998 160.463 12.8998Z"
                          fill="white"
                        />
                      </g>
                      <path
                        d="M192.195 55.5249C193.132 58.5511 192.211 62.1247 189.38 64.6671C182.007 71.2863 170.358 71.1887 170.358 71.1887C170.358 71.1887 172.408 86.4319 174.53 93.8561C174.53 93.8561 153.53 119.946 131.894 92.7954C131.894 92.7954 138.226 78.7075 141.003 63.075C134.877 63.6071 124.277 59.4362 123.933 51.0514C123.737 46.2685 127.781 41.4223 132.856 41.7306C137.784 42.0301 140.161 44.4027 144.802 47.6274C149.11 50.6203 149.646 48.279 150.94 43.2054C152.089 38.7021 154.421 34.4608 156.307 31.9879C160.568 26.3953 170.193 24.1352 176.726 23.373C177.346 25.9749 178.294 30.402 180.919 37.655C183.887 45.853 190.01 48.4625 192.195 55.5249Z"
                        fill="white"
                      />
                      <mask
                        id="mask7_3031_327669"
                        style="mask-type:luminance"
                        maskUnits="userSpaceOnUse"
                        x="122"
                        y="22"
                        width="72"
                        height="84"
                      >
                        <path
                          d="M171.205 71.9948C171.205 71.9948 182.559 72.1732 189.931 65.5538C192.763 63.0114 194.035 58.6424 193.115 55.6111C190.892 48.2817 184.608 45.5584 181.64 37.3608C179.015 30.1078 177.964 24.9905 177.345 22.3887C170.812 23.1508 159.859 25.3571 155.597 30.9497C153.711 33.4227 150.798 38.0114 149.649 42.5146C148.355 47.588 149.271 49.5326 144.963 46.5397C140.322 43.3149 137.486 40.9516 132.558 40.6522C127.483 40.3437 122.759 45.5785 122.765 51.1958C122.773 59.5876 133.791 64.4341 139.917 63.902C137.481 77.6122 133.304 87.764 132.069 90.6364L131.419 92.1915C150.011 116.509 167.927 101.255 173.336 95.3124C174.247 94.311 174.927 93.6485 175.064 93.5125L171.205 71.9948Z"
                          fill="white"
                        />
                      </mask>
                      <g mask="url(#mask7_3031_327669)">
                        <path
                          d="M175.047 96.086C174.806 96.086 174.579 95.9354 174.494 95.6944C172.208 89.2231 169.875 71.9973 169.776 71.2673C169.754 71.0987 169.805 70.9287 169.918 70.801C170.029 70.6746 170.19 70.602 170.358 70.602H170.374C170.789 70.602 181.974 70.5283 188.988 64.2307C191.54 61.9391 192.554 58.6696 191.634 55.6986C190.59 52.3235 188.593 49.9734 186.479 47.4857C184.23 44.8387 181.905 42.1019 180.367 37.8557C177.965 31.2177 176.941 26.8555 176.33 24.2488C176.312 24.1711 176.294 24.0946 176.276 24.0195C171.504 24.6234 161.175 26.5682 156.773 32.3442C154.989 34.685 152.669 38.8056 151.509 43.3511L151.463 43.5304C150.649 46.7244 150.111 48.8345 148.592 49.4012C147.572 49.7813 146.301 49.383 144.468 48.1099C143.688 47.5681 142.982 47.0581 142.3 46.565C138.961 44.1509 136.755 42.5561 132.82 42.3168C130.769 42.1938 128.768 42.9808 127.181 44.5371C125.419 46.2645 124.424 48.6911 124.519 51.0281C124.63 53.7295 125.856 56.128 128.162 58.1569C131.859 61.4105 137.395 62.7996 140.952 62.4911C141.134 62.4745 141.313 62.5449 141.436 62.6797C141.56 62.8144 141.613 62.9987 141.581 63.1783C138.823 78.7026 132.493 92.895 132.43 93.0366L132.19 93.57C132.057 93.866 131.709 93.9978 131.414 93.8648C131.118 93.7318 130.986 93.3846 131.119 93.089L131.359 92.5556C131.421 92.4175 137.497 78.7922 140.293 63.7023C136.601 63.8009 131.242 62.4304 127.386 59.0381C124.866 56.8208 123.47 54.0676 123.347 51.0762C123.238 48.413 124.364 45.6552 126.359 43.699C128.187 41.9076 130.508 40.9988 132.892 41.1455C137.167 41.4053 139.609 43.1707 142.988 45.6139C143.666 46.1039 144.367 46.6108 145.138 47.1462C146.582 48.1495 147.578 48.5266 148.182 48.3015C149.126 47.9495 149.629 45.9744 150.326 43.2405L150.372 43.0612C151.575 38.3451 153.985 34.0655 155.84 31.6328C160.681 25.2799 172.012 23.3331 176.659 22.7911C176.953 22.756 177.229 22.9487 177.298 23.238C177.353 23.4708 177.411 23.7183 177.473 23.981C178.118 26.7295 179.092 30.883 181.471 37.4562C182.936 41.5033 185.192 44.1583 187.374 46.726C189.568 49.3083 191.641 51.7472 192.756 55.3522C193.813 58.766 192.669 62.503 189.772 65.1045C183.256 70.9549 173.667 71.6781 171.03 71.7649C171.488 75.034 173.602 89.6456 175.601 95.3039C175.709 95.6095 175.548 95.9448 175.243 96.0527C175.178 96.0752 175.112 96.086 175.047 96.086Z"
                          fill="#343A40"
                        />
                      </g>
                      <path
                        d="M156.274 35.6734C155.791 30.1992 161.678 25.8565 165.707 28.1174C166.436 28.5263 166.695 29.4486 166.286 30.1773C166.018 30.6544 165.201 31.2072 164.696 31.6434C164.3 31.9538 162.774 33.3012 162.4 33.6396C161.543 34.4123 159.9 36.2219 159.993 36.1194C159.441 36.7266 158.952 37.2708 158.183 37.4993C157.322 37.7549 156.741 37.4293 156.503 36.8766C156.399 36.6349 156.294 35.9373 156.274 35.6734Z"
                        fill="#343A40"
                      />
                      <path
                        d="M159.841 40.2756C161.168 39.6737 164.384 38.3034 167.142 36.0353C167.53 35.716 168.101 35.7745 168.417 36.1648C169.231 37.1687 170.259 39.0219 168.181 40.3261C165.629 41.9283 160.967 42.0449 159.732 41.053C159.467 40.8398 159.531 40.4163 159.841 40.2756Z"
                        fill="#343A40"
                      />
                      <path
                        d="M178.234 33.2871C176.862 33.7787 175.797 33.9053 173.148 34.1637C172.648 34.2124 172.278 34.6435 172.323 35.1441C172.437 36.4314 173.335 37.5583 175.396 37.3314C177.692 37.0787 178.727 35.111 178.853 33.7689C178.885 33.4301 178.555 33.1723 178.234 33.2871Z"
                        fill="#343A40"
                      />
                      <mask
                        id="mask8_3031_327669"
                        style="mask-type:luminance"
                        maskUnits="userSpaceOnUse"
                        x="123"
                        y="23"
                        width="70"
                        height="83"
                      >
                        <path
                          d="M192.195 55.5253C193.132 58.5514 192.211 62.1251 189.38 64.6675C182.007 71.2867 170.358 71.1891 170.358 71.1891C170.358 71.1891 172.408 86.4323 174.53 93.8564C174.53 93.8564 153.53 121.007 131.894 92.7958C131.894 92.7958 138.226 78.7079 141.003 63.0754C134.877 63.6075 124.277 59.4366 123.933 51.0518C123.737 46.2688 127.781 41.4227 132.856 41.731C137.784 42.0305 140.161 44.4031 144.802 47.6278C149.11 50.6207 149.646 48.2794 150.94 43.2057C152.089 38.7025 154.421 34.4612 156.307 31.9882C160.568 26.3956 170.193 24.1355 176.726 23.3734C177.346 25.9753 178.294 30.4024 180.919 37.6554C183.887 45.8534 190.01 48.4629 192.195 55.5253Z"
                          fill="white"
                        />
                      </mask>
                      <g mask="url(#mask8_3031_327669)">
                        <path
                          d="M139.023 63.7544C137.824 63.7544 137.064 63.5905 136.994 63.5746C136.678 63.5036 136.479 63.1896 136.55 62.8733C136.621 62.5576 136.934 62.3591 137.25 62.4291C137.287 62.4377 140.895 63.1983 144.943 61.1357C145.232 60.9884 145.585 61.1028 145.732 61.3921C145.879 61.6811 145.764 62.0344 145.475 62.1815C142.949 63.469 140.605 63.7544 139.023 63.7544Z"
                          fill="#343A40"
                        />
                      </g>
                      <mask
                        id="mask9_3031_327669"
                        style="mask-type:luminance"
                        maskUnits="userSpaceOnUse"
                        x="123"
                        y="23"
                        width="70"
                        height="83"
                      >
                        <path
                          d="M192.195 55.5253C193.132 58.5514 192.211 62.1251 189.38 64.6675C182.007 71.2867 170.358 71.1891 170.358 71.1891C170.358 71.1891 172.408 86.4323 174.53 93.8564C174.53 93.8564 153.53 121.007 131.894 92.7958C131.894 92.7958 138.226 78.7079 141.003 63.0754C134.877 63.6075 124.277 59.4366 123.933 51.0518C123.737 46.2688 127.781 41.4227 132.856 41.731C137.784 42.0305 140.161 44.4031 144.802 47.6278C149.11 50.6207 149.646 48.2794 150.94 43.2057C152.089 38.7025 154.421 34.4612 156.307 31.9882C160.568 26.3956 170.193 24.1355 176.726 23.3734C177.346 25.9753 178.294 30.4024 180.919 37.6554C183.887 45.8534 190.01 48.4629 192.195 55.5253Z"
                          fill="white"
                        />
                      </mask>
                      <g mask="url(#mask9_3031_327669)">
                        <path
                          d="M182.057 26.4919C179.428 22.143 172.422 22.374 170.909 26.484C170.648 27.1926 171.011 27.9787 171.719 28.2395C172.267 28.4408 172.911 28.2364 176.422 28.3391C177.46 28.367 179.639 28.6446 179.532 28.6311C180.267 28.7248 180.922 28.812 181.585 28.5175C182.327 28.1878 182.535 27.6231 182.374 27.1038C182.32 26.9267 182.039 26.4621 182.057 26.4919Z"
                          fill="#343A40"
                        />
                      </g>
                      <mask
                        id="mask10_3031_327669"
                        style="mask-type:luminance"
                        maskUnits="userSpaceOnUse"
                        x="123"
                        y="23"
                        width="70"
                        height="83"
                      >
                        <path
                          d="M192.195 55.5274C193.132 58.5535 192.211 62.1272 189.38 64.6696C182.007 71.2888 170.358 71.1911 170.358 71.1911C170.358 71.1911 172.409 86.4344 174.53 93.8585C174.53 93.8585 153.53 121.01 131.894 92.7979C131.894 92.7979 138.226 78.71 141.003 63.0775C134.877 63.6095 124.277 59.4387 123.933 51.0539C123.737 46.2709 127.781 41.4248 132.856 41.7331C137.784 42.0326 140.161 44.4052 144.802 47.6298C149.11 50.6227 149.646 48.2814 150.94 43.2078C152.089 38.7046 154.421 34.4633 156.307 31.9903C160.568 26.3977 170.193 24.1376 176.726 23.3755C177.346 25.9773 178.294 30.4045 180.919 37.6575C183.887 45.8554 190.01 48.4649 192.195 55.5274Z"
                          fill="white"
                        />
                      </mask>
                      <g mask="url(#mask10_3031_327669)">
                        <path
                          d="M170.358 71.1889C170.358 71.1889 162.695 70.5977 158.125 67.6144C156.852 68.8102 158.797 78.8749 171.163 79.738C180.653 80.4005 170.358 71.1889 170.358 71.1889Z"
                          fill="#343A40"
                        />
                        <path
                          d="M172.078 80.359C171.778 80.359 171.46 80.3471 171.122 80.3236C167.377 80.0621 164.237 78.9622 161.787 77.0538C159.912 75.5935 158.468 73.6319 157.719 71.53C157.026 69.585 157.028 67.8396 157.723 67.1866C157.921 67.0016 158.219 66.975 158.446 67.1232C162.834 69.988 170.328 70.5983 170.403 70.604C170.531 70.614 170.653 70.6658 170.749 70.7519C171.752 71.6497 176.703 76.2598 175.607 78.853C175.18 79.863 174.022 80.359 172.078 80.359ZM158.397 68.4714C158.329 69.0371 158.406 70.0958 158.945 71.4553C159.784 73.5709 162.658 78.5563 171.204 79.1527C173.085 79.2843 174.264 79.0156 174.526 78.3963C175.082 77.08 172.324 73.7731 170.111 71.7565C169.55 71.7041 167.894 71.5263 165.835 71.095C162.791 70.4577 160.294 69.5762 158.397 68.4714Z"
                          fill="#343A40"
                        />
                      </g>
                      <path
                        d="M179.341 50.3685C179.084 50.8466 178.706 51.2476 178.285 51.5723C177.86 51.8945 177.389 52.1441 176.895 52.3219C175.908 52.6777 174.831 52.7906 173.755 52.5651C173.229 52.445 172.731 52.2517 172.261 51.9929C171.798 51.7261 171.366 51.4018 171.003 51.0094C170.27 50.2373 169.779 49.215 169.724 48.1577C169.712 47.9165 169.897 47.7107 170.139 47.6982C170.346 47.6874 170.527 47.8228 170.582 48.0141L170.585 48.0268C170.82 48.8425 171.283 49.5591 171.892 50.1125C172.2 50.385 172.535 50.6269 172.903 50.8096C173.264 51.0006 173.658 51.1418 174.053 51.2304C174.827 51.4045 175.698 51.348 176.506 51.1291C177.315 50.9039 178.076 50.499 178.618 49.8832L178.627 49.8728C178.787 49.6915 179.063 49.6739 179.245 49.8335C179.4 49.9703 179.435 50.1935 179.341 50.3685Z"
                        fill="#343A40"
                      />
                      <path
                        d="M142.112 55.2084C141.909 55.2084 141.711 55.1024 141.603 54.9132C139.832 51.8264 137.459 49.9875 134.549 49.4482C132.39 49.0481 130.754 49.5418 130.737 49.5469C130.428 49.6418 130.099 49.4695 130.003 49.1598C129.907 48.8502 130.08 48.5215 130.39 48.4257C130.468 48.4018 132.321 47.8424 134.763 48.2942C137.007 48.7103 140.192 50.095 142.621 54.3297C142.782 54.6108 142.685 54.9695 142.404 55.1307C142.312 55.1832 142.211 55.2084 142.112 55.2084Z"
                        fill="#343A40"
                      />
                      <path
                        d="M176.42 44.442C176.277 44.442 176.134 44.39 176.021 44.2849C175.784 44.0641 175.77 43.6928 175.991 43.4555C176.923 42.4536 177.347 41.7212 177.289 41.2161C177.225 40.6549 176.528 40.1485 175.388 39.3811C174.069 38.4932 173.161 37.5141 172.689 36.4709C172.313 35.6398 172.362 35.0596 172.368 34.9962C172.402 34.6738 172.693 34.4387 173.014 34.4745C173.332 34.5083 173.564 34.7912 173.536 35.1093C173.534 35.1603 173.499 36.6945 176.043 38.4075C177.267 39.2312 178.324 39.9429 178.455 41.0819C178.557 41.9726 178.063 42.9512 176.85 44.2548C176.735 44.3792 176.578 44.442 176.42 44.442Z"
                        fill="#343A40"
                      />
                      <path
                        d="M106.277 217.025C106.277 218.828 107.739 220.29 109.543 220.289L187.844 220.271L191.819 220.269C192.455 218.08 193.13 215.901 193.911 213.761L109.542 213.76C107.739 213.76 106.277 215.222 106.277 217.025Z"
                        fill="#343A40"
                      />
                      <path
                        d="M109.542 220.878C108.514 220.878 107.546 220.477 106.819 219.75C106.091 219.022 105.69 218.055 105.69 217.026C105.69 214.903 107.418 213.175 109.542 213.175L193.911 213.176C194.102 213.176 194.281 213.269 194.391 213.426C194.501 213.583 194.528 213.784 194.462 213.964C193.786 215.817 193.145 217.812 192.383 220.434C192.31 220.685 192.08 220.857 191.819 220.857L109.542 220.878C109.542 220.878 109.543 220.878 109.542 220.878ZM109.542 214.349C108.065 214.349 106.864 215.55 106.864 217.026C106.864 217.742 107.143 218.414 107.649 218.92C108.155 219.426 108.827 219.704 109.542 219.704L191.379 219.684C191.991 217.598 192.53 215.906 193.077 214.349L109.542 214.349Z"
                        fill="#343A40"
                      />
                      <path
                        d="M187.835 220.29H286.557L310.729 155.685C311.863 152.653 309.622 149.422 306.386 149.422H222.155C217.461 149.422 213.259 152.336 211.614 156.732L187.835 220.29Z"
                        fill="white"
                      />
                      <path
                        d="M286.557 220.875H187.835C187.643 220.875 187.462 220.781 187.353 220.623C187.243 220.465 187.218 220.263 187.285 220.083L211.065 156.526C212.786 151.925 217.243 148.834 222.155 148.834H306.386C308.098 148.834 309.703 149.674 310.678 151.081C311.654 152.488 311.879 154.285 311.279 155.889L287.107 220.494C287.021 220.723 286.802 220.875 286.557 220.875ZM188.681 219.702H286.15L310.18 155.478C310.652 154.216 310.482 152.857 309.714 151.75C308.946 150.642 307.733 150.008 306.386 150.008H222.155C217.73 150.008 213.715 152.792 212.164 156.937L188.681 219.702Z"
                        fill="#343A40"
                      />
                      <path
                        d="M177.703 217.759C177.702 217.759 177.701 217.759 177.7 217.759L170.746 217.735C170.314 217.733 169.965 217.382 169.966 216.949C169.968 216.518 170.318 216.17 170.749 216.17H170.752L177.706 216.195C178.138 216.196 178.487 216.548 178.486 216.98C178.484 217.411 178.134 217.759 177.703 217.759Z"
                        fill="white"
                      />
                      <path
                        d="M252.205 192.856C251.941 192.856 251.675 192.834 251.406 192.788C249.885 192.529 248.557 191.692 247.665 190.434C246.774 189.175 246.426 187.645 246.685 186.124C247.339 182.294 250.61 179.99 254.465 180.649C256.752 181.039 258.635 182.232 259.766 184.006C260.936 185.84 261.221 188.17 260.568 190.565C260.482 190.878 260.158 191.062 259.847 190.976C259.534 190.891 259.35 190.568 259.435 190.256C260 188.184 259.766 186.189 258.777 184.637C257.826 183.145 256.224 182.14 254.268 181.805C251.032 181.254 248.391 183.11 247.842 186.321C247.415 188.822 249.103 191.204 251.603 191.631C253.541 191.962 255.385 190.655 255.716 188.718C255.969 187.233 254.967 185.818 253.481 185.564C252.355 185.371 251.285 186.131 251.093 187.255C250.951 188.091 251.515 188.888 252.351 189.03C252.671 189.085 252.997 188.998 253.247 188.791C253.497 188.585 253.867 188.621 254.073 188.871C254.279 189.121 254.243 189.491 253.994 189.697C253.48 190.12 252.808 190.299 252.153 190.187C250.679 189.936 249.685 188.532 249.937 187.058C250.238 185.295 251.915 184.107 253.679 184.407C255.803 184.769 257.235 186.792 256.873 188.916C256.479 191.222 254.47 192.856 252.205 192.856Z"
                        fill="#343A40"
                      />
                      <path
                        d="M148.578 202.745C145.691 200.085 140.541 196.213 137.527 194.205C146.673 198.19 158.946 200.567 145.886 191.274C135.201 183.768 111.791 177.602 97.9462 175.23C93.1771 174.413 88.2113 173.862 83.1979 173.415C83.5905 173.001 83.9817 172.581 84.3704 172.148C130.564 120.735 123.663 90.8719 115.335 88.4729C76.4694 77.2724 31.5104 131.863 10.1295 165.76C9.25975 167.126 6.71442 171.332 4.55504 176.947C1.48566 184.933 -0.805161 195.768 3.60905 205.354C9.6989 218.575 21.4821 224.412 41.5546 224.412C65.7466 224.414 95.5448 216.456 116.824 215.529C123.425 215.24 128.811 215.346 135.197 216.163C142.357 217.078 143.91 216.073 140.832 213.287C140.832 213.287 144.214 214.33 146.804 214.92C150.618 215.79 151.629 213.356 149.156 210.316C149.156 210.316 161.388 214.549 148.578 202.745ZM140.801 213.259C140.812 213.269 140.82 213.276 140.825 213.281C140.817 213.273 140.809 213.267 140.801 213.259Z"
                        fill="white"
                      />
                      <path
                        d="M41.5643 225C41.5608 225 41.5579 225 41.5545 225C21.1233 225 9.25615 219.016 3.07593 205.6C0.54899 200.112 -1.34044 190.651 4.00744 176.737C6.15841 171.144 8.65914 166.977 9.63467 165.445C16.0741 155.236 33.4649 129.369 55.7884 109.764C65.9973 100.799 75.9219 94.3217 85.2862 90.5137C96.0876 86.1214 106.252 85.2449 115.498 87.9093C117.917 88.6061 119.933 91.1992 121.03 95.0236C122.22 99.1767 123.315 108.434 117.272 123.769C111.385 138.707 100.462 155.116 84.8069 172.54C84.6892 172.671 84.5687 172.804 84.4442 172.94C89.817 173.439 94.1641 173.987 98.0453 174.652C105.825 175.985 115.257 178.271 123.275 180.767C130.381 182.978 140.13 186.513 146.224 190.794C152.237 195.073 152.521 196.579 152.007 197.489C151.044 199.19 145.93 197.914 141.724 196.459C144.318 198.38 147.122 200.605 148.976 202.313C155.218 208.066 155.373 209.884 154.81 210.826C154.145 211.94 152.098 211.708 150.543 211.334C151.194 212.573 151.279 213.699 150.755 214.542C150.373 215.157 149.334 216.099 146.674 215.493C145.344 215.19 143.797 214.765 142.605 214.423C142.901 214.931 143.031 215.46 142.804 215.954C142.256 217.144 140.031 217.373 135.123 216.745C129.212 215.989 123.918 215.807 116.85 216.115C107.416 216.526 96.3824 218.311 84.7005 220.201C70.1175 222.56 55.0376 225 41.5643 225ZM104.673 87.5789C98.6544 87.5789 92.3173 88.9216 85.7281 91.6011C76.4855 95.3597 66.6729 101.768 56.5626 110.646C34.3544 130.15 17.0392 155.905 10.6256 166.073C9.66792 167.578 7.21531 171.665 5.10268 177.158C-0.0981004 190.69 1.70957 199.827 4.14183 205.109C10.1045 218.054 21.643 223.826 41.5545 223.826H41.5643C54.9439 223.826 69.9749 221.394 84.5135 219.043C96.2302 217.147 107.297 215.357 116.799 214.943C123.938 214.631 129.29 214.816 135.272 215.581C141.156 216.334 141.696 215.555 141.738 215.464C141.74 215.46 141.881 215.029 140.439 213.723C140.436 213.721 140.434 213.719 140.431 213.716C140.43 213.715 140.429 213.714 140.428 213.713L140.427 213.713L140.411 213.698C140.169 213.482 140.148 213.112 140.363 212.87C140.554 212.655 140.867 212.614 141.105 212.758C141.682 212.933 144.642 213.826 146.935 214.349C148.338 214.669 149.394 214.51 149.759 213.923C150.179 213.246 149.774 212.006 148.701 210.688C148.535 210.484 148.525 210.196 148.675 209.981C148.825 209.766 149.099 209.677 149.348 209.763C151.4 210.472 153.524 210.692 153.803 210.224C153.877 210.1 154.344 208.857 148.181 203.177C145.356 200.574 140.282 196.747 137.202 194.694C136.949 194.526 136.866 194.192 137.012 193.925C137.157 193.658 137.483 193.546 137.762 193.668C140.687 194.942 143.97 196.059 146.546 196.654C150.427 197.552 150.981 196.919 150.985 196.912C150.99 196.903 151.343 195.878 145.546 191.753C139.666 187.623 122.108 179.966 97.8471 175.81C93.7142 175.101 89.0427 174.527 83.1458 174.001C82.9216 173.981 82.7285 173.835 82.6491 173.624C82.5695 173.414 82.6172 173.176 82.7721 173.013C83.2013 172.56 83.5814 172.149 83.9337 171.757C99.4954 154.437 110.344 138.147 116.18 123.339C122.096 108.327 121.051 99.3576 119.901 95.3475C118.933 91.9705 117.166 89.6117 115.173 89.0376C111.798 88.0646 108.293 87.5789 104.673 87.5789Z"
                        fill="#343A40"
                      />
                      <mask
                        id="mask11_3031_327669"
                        style="mask-type:luminance"
                        maskUnits="userSpaceOnUse"
                        x="41"
                        y="175"
                        width="114"
                        height="50"
                      >
                        <path
                          d="M148.578 202.744C145.692 200.084 143.029 197.2 140.015 195.19C146.52 197.905 159.63 199.478 146.568 190.185C146.312 190.004 146.056 189.823 145.8 189.645C138.931 184.871 113.613 179.83 86.9588 175.632C51.5517 170.056 41.5554 224.413 41.5554 224.413C41.5554 224.413 95.545 216.457 116.825 215.529C123.424 215.241 127.12 216.119 133.256 218.065C143.552 221.331 143.657 215.598 141.7 213.689C142.253 213.935 155.465 218.49 148.829 210.53C148.829 210.53 161.388 214.549 148.578 202.744Z"
                          fill="white"
                        />
                      </mask>
                      <g mask="url(#mask11_3031_327669)">
                        <path
                          d="M141.224 196.755C141.12 196.755 141.015 196.727 140.919 196.669C134.215 192.589 125.765 190.737 125.68 190.719C125.363 190.65 125.162 190.338 125.23 190.022C125.298 189.705 125.61 189.504 125.927 189.571C126.013 189.59 134.652 191.481 141.53 195.667C141.806 195.835 141.894 196.196 141.726 196.473C141.615 196.655 141.422 196.755 141.224 196.755Z"
                          fill="#343A40"
                        />
                      </g>
                      <mask
                        id="mask12_3031_327669"
                        style="mask-type:luminance"
                        maskUnits="userSpaceOnUse"
                        x="41"
                        y="175"
                        width="114"
                        height="50"
                      >
                        <path
                          d="M148.578 202.744C145.692 200.084 143.029 197.2 140.015 195.19C146.52 197.905 159.63 199.478 146.568 190.185C146.312 190.004 146.056 189.823 145.8 189.645C138.931 184.871 113.613 179.83 86.9588 175.632C51.5517 170.056 41.5554 224.413 41.5554 224.413C41.5554 224.413 95.545 216.457 116.825 215.529C123.424 215.241 127.12 216.119 133.256 218.065C143.552 221.331 143.657 215.598 141.7 213.689C142.253 213.935 155.465 218.49 148.829 210.53C148.829 210.53 161.388 214.549 148.578 202.744Z"
                          fill="white"
                        />
                      </mask>
                      <g mask="url(#mask12_3031_327669)">
                        <path
                          d="M149.818 211.493C149.676 211.493 149.533 211.442 149.42 211.338C143.082 205.487 130.773 198.9 121.981 196.656C121.668 196.576 121.478 196.256 121.558 195.942C121.638 195.628 121.956 195.437 122.272 195.518C131.373 197.843 143.648 204.412 150.217 210.475C150.455 210.695 150.47 211.066 150.25 211.304C150.134 211.43 149.977 211.493 149.818 211.493Z"
                          fill="#343A40"
                        />
                      </g>
                      <mask
                        id="mask13_3031_327669"
                        style="mask-type:luminance"
                        maskUnits="userSpaceOnUse"
                        x="41"
                        y="175"
                        width="114"
                        height="50"
                      >
                        <path
                          d="M148.578 202.746C145.692 200.086 143.029 197.201 140.015 195.192C146.52 197.907 159.629 199.48 146.568 190.187C146.312 190.006 146.056 189.825 145.8 189.647C138.931 184.873 113.613 179.832 86.9587 175.634C51.5516 170.058 41.5554 224.415 41.5554 224.415C41.5554 224.415 95.545 216.459 116.825 215.531C123.424 215.243 127.12 216.121 133.256 218.067C143.552 221.333 143.657 215.6 141.7 213.691C142.253 213.937 155.465 218.492 148.829 210.532C148.829 210.532 161.388 214.551 148.578 202.746Z"
                          fill="white"
                        />
                      </mask>
                      <g mask="url(#mask13_3031_327669)">
                        <path
                          d="M141.97 214.71C141.82 214.71 141.67 214.653 141.555 214.538C137.677 210.661 120.551 204.685 120.379 204.625C120.073 204.518 119.91 204.184 120.017 203.878C120.123 203.572 120.457 203.409 120.764 203.516C121.478 203.764 138.317 209.641 142.385 213.708C142.614 213.937 142.614 214.309 142.385 214.538C142.27 214.653 142.12 214.71 141.97 214.71Z"
                          fill="#343A40"
                        />
                      </g>
                      <path
                        d="M85.6455 174.129C85.023 174.071 83.9872 173.978 83.1752 173.908C75.0201 173.218 66.7202 172.905 59.5118 172.64C44.1933 164.918 26.0529 157.306 15.7831 156.477C26.3523 139.838 41.9664 121.448 59.4981 106.92C69.3045 98.7939 78.9246 92.742 89.5014 89.4733C97.7798 86.9147 108.8 83.9875 117.091 87.4645C126.767 91.5221 131.84 122.716 85.6455 174.129Z"
                        fill="#009999"
                      />
                      <path
                        d="M145.886 191.861C145.769 191.861 145.652 191.827 145.549 191.755C134.812 184.213 111.139 178.087 97.8464 175.809C93.547 175.073 88.737 174.486 83.1411 174.013C74.8181 173.309 66.3277 172.998 59.5053 172.747C59.1815 172.735 58.9286 172.463 58.9403 172.139C58.9523 171.816 59.2306 171.564 59.5481 171.575C66.3829 171.825 74.8891 172.137 83.2397 172.844C88.8689 173.319 93.7115 173.911 98.0443 174.652C111.442 176.948 135.328 183.141 146.224 190.794C146.489 190.98 146.553 191.346 146.367 191.612C146.253 191.775 146.071 191.861 145.886 191.861Z"
                        fill="#343A40"
                      />
                    </svg>

                    <h2 class="text-2xl font-medium leading-tight tracking-tight mb-12 mt-6 text-[#343A40]">
                      Não conseguimos encontrar uma correspondência
                    </h2>
                    {isHaveFilter && (
                      <div>
                        {" "}
                        <p class="text-base font-normal leading-normal tracking-normal mb-6 text-[#343A40]">
                          Vamos limpar seus filtros e começar de novo.
                        </p>
                        <div class="mb-6">
                          <ClearFiltersButton />
                        </div>
                      </div>
                    )}

                    <div class="mt-4">
                      <p class="text-base font-normal leading-normal tracking-normal m-0 mb-4">
                        Voltar para
                        <a
                          class="text-[#009999] underline underline-offset-[3.5px] text-lg font-normal hover:text-inherit ml-1"
                          href="/"
                        >
                          Home
                        </a>
                      </p>
                    </div>
                  </div>
                </div>
              )}
            {products &&
              products.length > 0 &&
              page.relatedTerms &&
              page.relatedTerms.length > 0 && (
              <div className="flex flex-col gap-8 lg:pt-9 pt-3 lg:pl-8 overflow-auto max-w-[96vw] mx-3 lg:max-w-[900px] lg:mx-auto lg:px-5">
                <span class="text-[28px]">Buscas Relacionadas</span>
                <div class="sticky top-0 bg-white z-[3] mb-6">
                  {/* Carrossel de navegação */}
                  <div
                    id={idTerm}
                    class="max-w-full mx-auto flex flex-col relative py-3"
                  >
                    <Slider class="carousel carousel-center gap-4 row-start-2 row-end-5 hide-scrollbar snap-x snap-mandatory">
                      {page.relatedTerms.map((term, index) => {
                        return (
                          <Slider.Item index={index}>
                            <a href={`/b/${term.termValue}`}>
                              <div className="flex gap-1 text-nowrap group text-[#343A40] hover:bg-[#343A40] transition-[0.5s] hover:text-white border border-[#343A40] items-center rounded px-2 py-1">
                                <svg
                                  className="me-1"
                                  xmlns="http://www.w3.org/2000/svg"
                                  width="16"
                                  height="16"
                                  viewBox="0 0 16 16"
                                  fill="none"
                                >
                                  <g clip-path="url(#clip0_22113_136303)">
                                    <path
                                      d="M11.7414 10.3431C12.7097 9.02181 13.1434 7.38361 12.9557 5.75627C12.7681 4.12893 11.9728 2.63246 10.7292 1.56625C9.48555 0.500045 7.88518 -0.0572725 6.24827 0.00580065C4.61136 0.0688738 3.05862 0.747686 1.9007 1.90643C0.742785 3.06518 0.0650835 4.6184 0.00318169 6.25536C-0.0587201 7.89231 0.499742 9.49228 1.56684 10.7352C2.63394 11.9781 4.13098 12.7722 5.75845 12.9587C7.38593 13.1452 9.02381 12.7104 10.3444 11.7411H10.3434C10.3734 11.7811 10.4054 11.8191 10.4414 11.8561L14.2914 15.7061C14.4789 15.8938 14.7333 15.9992 14.9986 15.9993C15.2638 15.9994 15.5183 15.8941 15.7059 15.7066C15.8936 15.5191 15.999 15.2647 15.9991 14.9995C15.9992 14.7342 15.8939 14.4798 15.7064 14.2921L11.8564 10.4421C11.8207 10.4059 11.7822 10.3725 11.7414 10.3421V10.3431ZM11.9994 6.49912C11.9994 7.22139 11.8572 7.93659 11.5808 8.60388C11.3044 9.27117 10.8992 9.87749 10.3885 10.3882C9.8778 10.8989 9.27148 11.3041 8.60419 11.5805C7.9369 11.8569 7.2217 11.9991 6.49943 11.9991C5.77716 11.9991 5.06196 11.8569 4.39467 11.5805C3.72738 11.3041 3.12107 10.8989 2.61035 10.3882C2.09962 9.87749 1.6945 9.27117 1.4181 8.60388C1.14169 7.93659 0.999433 7.22139 0.999433 6.49912C0.999433 5.04043 1.5789 3.64149 2.61035 2.61004C3.6418 1.57859 5.04074 0.999124 6.49943 0.999124C7.95812 0.999124 9.35707 1.57859 10.3885 2.61004C11.42 3.64149 11.9994 5.04043 11.9994 6.49912Z"
                                      fill="#212529"
                                      className="group-hover:fill-white"
                                    >
                                    </path>
                                  </g>
                                  <defs>
                                    <clipPath id="clip0_22113_136303">
                                      <rect
                                        width="16"
                                        height="16"
                                        fill="white"
                                      >
                                      </rect>
                                    </clipPath>
                                  </defs>
                                </svg>
                                {term.title}
                              </div>
                            </a>
                          </Slider.Item>
                        );
                      })}
                    </Slider>

                    {/* Botões de navegação do carrossel */}
                    <div class="absolute left-0 top-1/2 -translate-y-1/2 z-10">
                      <Slider.PrevButton class="disabled:hidden border rounded-full w-9 h-9 bg-white flex items-center justify-center border-[#212529] hover:bg-gray-100">
                        <Icon
                          size={24}
                          id="ChevronLeft"
                          strokeWidth={3}
                          class="w-5"
                        />
                      </Slider.PrevButton>
                    </div>
                    <div class="absolute right-0 top-1/2 -translate-y-1/2 z-10">
                      <Slider.NextButton class="disabled:hidden border rounded-full w-9 h-9 bg-white flex items-center justify-center border-[#212529] hover:bg-gray-100">
                        <Icon size={24} id="ChevronRight" strokeWidth={3} />
                      </Slider.NextButton>
                    </div>

                    <Slider.JS rootId={idTerm} />
                  </div>
                </div>
                <div className="flex gap-2"></div>
              </div>
            )}
            {products && products.length > 0 && format == "Pagination" && (
              <div class="flex justify-center my-8 ">
                <div class="flex flex-col justify-center items-center">
                  <div class="w-fit border border-neutral rounded-lg flex items-center justify-center">
                    {pageInfo.previousPage
                      ? (
                        <a
                          aria-label="page link"
                          href={`${url.pathname}`}
                          class={`text-primary border-r border-neutral px-4  flex items-center h-12 ${
                            pageInfo.previousPage
                              ? "hover:bg-slate-100 duration-300"
                              : "pointer-events-none bg-gray-100"
                          }`}
                        >
                          ‹‹
                        </a>
                      )
                      : (
                        <p
                          class={`text-primary border-r border-neutral px-4  flex items-center h-12 ${
                            pageInfo.previousPage
                              ? "hover:bg-slate-100 duration-300"
                              : "pointer-events-none bg-gray-100"
                          }`}
                        >
                          ‹‹
                        </p>
                      )}
                    {pageInfo.previousPage
                      ? (
                        <a
                          aria-label="page previous link"
                          href={pageInfo.previousPage == "?pagina=1"
                            ? url.pathname
                            : pageInfo.previousPage}
                          class={`btn btn-ghost join-item text-primary rounded-none ${
                            pageInfo.previousPage
                              ? ""
                              : "pointer-events-none bg-gray-100"
                          }`}
                        >
                          ‹
                        </a>
                      )
                      : (
                        <p
                          class={`btn btn-ghost join-item text-primary rounded-none ${
                            pageInfo.previousPage
                              ? ""
                              : "pointer-events-none bg-gray-100"
                          }`}
                        >
                          ‹
                        </p>
                      )}

                    <span class="border-l border-r border-neutral px-6 h-12 flex items-center">
                      {zeroIndexedOffsetPage + 1}
                    </span>
                    {pageInfo.nextPage
                      ? (
                        <a
                          aria-label="page next link"
                          href={pageInfo.nextPage ?? "#"}
                          class={`btn btn-ghost join-item text-primary rounded-none ${
                            pageInfo.nextPage
                              ? ""
                              : "pointer-events-none bg-gray-100"
                          }`}
                        >
                          ›
                        </a>
                      )
                      : (
                        <p
                          class={`btn btn-ghost join-item text-primary rounded-none ${
                            pageInfo.nextPage
                              ? ""
                              : "pointer-events-none bg-gray-100"
                          }`}
                        >
                          ›
                        </p>
                      )}

                    {pageInfo.nextPage
                      ? (
                        <a
                          aria-label="page link"
                          href={`?pagina=${
                            pageInfo.records == 10000
                              ? totalPages - 1
                              : totalPages
                          }`}
                          class={` text-primary border-l border-neutral px-4 h-12 flex items-center  ${
                            pageInfo.nextPage
                              ? "hover:bg-slate-100 duration-300"
                              : "pointer-events-none bg-gray-100"
                          }`}
                        >
                          ››
                        </a>
                      )
                      : (
                        <p
                          class={` text-primary border-l border-neutral px-4 h-12 flex items-center  ${
                            pageInfo.nextPage
                              ? "hover:bg-slate-100 duration-300"
                              : "pointer-events-none bg-gray-100"
                          }`}
                        >
                          ››
                        </p>
                      )}
                  </div>

                  <div class="mt-4">
                    <p>
                      <span class="font-semibold mr-1">Atual:</span>
                      <span>
                        {currentPage == 0
                          ? "1"
                          : (pageInfo?.recordPerPage ?? 24) * currentPage} até
                        {" "}
                        {(pageInfo?.records ?? 0) <
                              (pageInfo?.recordPerPage ?? 0) ||
                            (pageInfo?.recordPerPage ?? 24) *
                                  pageInfo.currentPage >
                              (pageInfo?.records ?? 0)
                          ? pageInfo?.records ?? 0
                          : (pageInfo?.recordPerPage ?? 24) *
                            pageInfo.currentPage}
                      </span>
                      <span>
                        <span class="mx-1">|</span>
                      </span>
                      <span class="font-semibold">Total:</span>
                      <span>{pageInfo?.records} registros</span>
                    </p>
                  </div>
                </div>
              </div>
            )}
          </div>
        </div>
        {page.categoryContent?.description && (
          <div
            class="content-seo pt-6 lg:pt-8 max-lg:px-4"
            dangerouslySetInnerHTML={{
              __html: page.categoryContent?.description,
            }}
          >
          </div>
        )}
        {contentSeoSubstance && (
          <div class="pt-6 lg:pt-8 max-lg:px-4 mx-auto max-w-[800px]">
            <ContenteSeoSubtance
              contentSeoSubtance={contentSeoSubstance}
              prescription={page?.prescriptionType}
            />
          </div>
        )}
        {contentSeo && (
          <div class="pt-6 lg:pt-8 max-lg:px-4 mx-auto max-w-[800px]">
            <ContentSeo contentSeo={contentSeo} />
          </div>
        )}
        {factoryDescription && (
          <div class="pt-6 lg:pt-8 max-lg:px-4">
            <ContentFactory contentSeo={factoryDescription} />
          </div>
        )}
      </div>

      <SendEventOnView
        id={id}
        event={{
          name: "view_item_list",
          params: {
            // TODO: get category name from search or cms setting
            item_list_name: breadcrumb.itemListElement?.at(-1)?.name,
            item_list_id: breadcrumb.itemListElement?.at(-1)?.item,
            items: page.products?.map((product, index) =>
              mapProductToAnalyticsItem({
                ...useOffer(product.offers),
                index: offset + index,
                product,
                breadcrumbList: page.breadcrumb,
              })
            ),
          },
        }}
      />
    </>
  );
}

function SearchResult({ page, ...props }: ReturnType<typeof loader>) {
  if (!page) {
    return <NotFound />;
  }

  return <Result {...props} page={page} />;
}

export const loader = (props: Props, req: Request, ctx: AppContext) => {
  const endsWithPa = req.url
    ?.split("/")
    ?.slice(-3)
    ?.some((segment) => segment === "pa");

  const isPageSubstance = !props.page?.contentSeoSubstance && endsWithPa;

  if (!props.page || (props.page.products.length === 0 && isPageSubstance)) {
    ctx.response.status = 404;
  }

  return {
    ...props,
    url: req.url,
  };
};

export default SearchResult;
